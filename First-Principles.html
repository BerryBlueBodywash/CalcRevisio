<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>First Principles - Lesson I</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@700&display=swap" rel="stylesheet" />

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background: #f2f2f2;
      display: flex;
      justify-content: center;
      align-items: stretch;
      min-height: 100%;
    }

    .app-container {
      background: white;
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #f0f0f0;
      padding: 10px 16px;
      font-weight: bold;
      font-size: 18px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .home-button {
      width: 28px;
      height: 28px;
      margin-right: 0.75rem;
      background-image: url('https://img.icons8.com/ios-filled/50/00695c/home.png');
      background-size: contain;
      background-repeat: no-repeat;
      background-position: center;
      flex-shrink: 0;
    }

    .progress-container {
      flex: 1;
      height: 10px;
      background-color: #eee;
      border-radius: 5px;
      margin-right: 0.75rem;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      width: 50%; 
      background-color: #e1baff;
    }

    .lesson-title {
      font-weight: 700;
      font-size: 0.95rem;
      white-space: nowrap;
      flex-shrink: 0;
      font-family: 'League Spartan', sans-serif;
    }

    .app-container {
      background: white;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .slider {
      display: flex;
      flex: 1;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
    }

    .slide {
      flex: 0 0 100%;
      scroll-snap-align: start;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      overflow-y: auto;
      padding: 1rem 1rem;
    }

    .text-card {
      background: #ffffff;
      border-radius: 20px;
      padding: 0.5rem;
      width: 100%;
      max-width: 340px;
    }

    .text-card p {
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 1rem;
      color: #333;
    }

    .highlight-red {
      color: #ec3649;
    }

    .highlight-blue {
      color: #2a81f4;
    }

    .highlight-bold {
      font-weight: bold;
    }

    .bangla-image {
      display: block;
      width: 100%;
      max-width: 300px;
      margin: 1rem auto 0.5rem;
    }

    .bangla-pronounce {
      text-align: center;
      font-size: 0.9rem;
      margin-bottom: 1.5rem;
    }

    .bangla-row {
      font-size: 1.5rem;
      text-align: center;
    }

    .nav-indicator {
      text-align: center;
      margin-top: 1.5rem;
      font-size: 1.2rem;
    }

    .match-item {
      background-color: #ffffff;
      border: 2px solid #ccc;
      padding: 1rem 1.5rem;
      border-radius: 16px;
      font-size: 2rem;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.3s
      user-select: none;
    }

    .match-item.correct {
      background-color: #a5d6a7;
      border-color: #388e3c;
    }

    .match-item.wrong {
      background-color: #ef9a9a;
      border-color: #c62828;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <div class="top-bar">
      <a href="index.html" class="home-button" aria-label="Go Home"></a>
      <div class="progress-container">
        <div class="progress-bar"></div>
      </div>
      <div class="lesson-title">First Principles - Lesson I</div>
    </div>

    <div class="slider" id="slider">

       <section class="slide">
        <div class="text-card">
          <p>
            <span class="highlight-bold">Calculus</span> is the branch of mathematics that studies <span class="highlight-blue">change</span>. Its two main ideas are <span class="highlight-bold">derivatives</span> (how things change instantly) and <span class="highlight-bold">integrals</span> (adding up change).
          </p>
          <p>
            Derivatives help us answer questions like: “How fast am I going <em>right now</em>?” or “How does a curve bend at this point?”
          </p>
          <img src="images/calculus-curve.png" alt="Curve with tangent" class="bangla-image" />
        </div>
      </section>

      <section class="slide">
        <div class="text-card">
          <p>
            The <span class="highlight-bold">derivative</span> of a function tells us its <span class="highlight-blue">instantaneous rate of change</span> at any point.
          </p>
          <p>
            For a straight line, the derivative is just its slope. For curves, the derivative is the slope of the <span class="highlight-red">tangent</span> at a single point.
          </p>
          <img src="images/tangent-slope.png" alt="Tangent line on a curve" class="bangla-image" />
        </div>
      </section>

      <section class="slide">
        <div class="text-card">
          <p>
            One of the most important rules in calculus is the <span class="highlight-bold">power rule</span>:
          </p>
          <p>
            If <span class="highlight-bold">f(x) = xⁿ</span>, then <span class="highlight-blue">f'(x) = n·xⁿ⁻¹</span>
          </p>
          <p>
            Example: The derivative of <span class="highlight-bold">x²</span> is <span class="highlight-blue">2x</span>. The derivative of <span class="highlight-bold">x³</span> is <span class="highlight-blue">3x²</span>.
          </p>
          <img src="images/power-rule.png" alt="Power rule example" class="bangla-image" />
        </div>
      </section>

      <section class="slide">
        <div class="text-card">
          <p>
            <span class="highlight-bold">Derivatives</span> are everywher! They’re used in physics to find velocity and acceleration, in economics to optimise profit, and in biology to study growth rates.
          </p>
          <p>
            Understanding how things change lets us predict, control, and improve the world around us.
          </p>
          <img src="images/applications.png" alt="Applications of derivatives" class="bangla-image" />
        </div>
      </section>

      <section class="slide">
        <div class="text-card" style="text-align: center;">
          <h2>Watch and Learn!</h2>
          <p>Here are four video links to deepen your understanding of calculus and derivatives:</p>
          <div style="display: flex; flex-direction: column; gap: 1rem; margin: 2rem 0;">
            <a href="#" target="_blank" style="background: #e1baff; padding: 0.75rem 1rem; border-radius: 12px; font-weight: bold; text-decoration: none; color: #333;">Video 1: First Principles?</a>
            <a href="#" target="_blank" style="background: #e1baff; padding: 0.75rem 1rem; border-radius: 12px; font-weight: bold; text-decoration: none; color: #333;">Video 2: Intro to Calculus Part 1</a>
            <a href="#" target="_blank" style="background: #e1baff; padding: 0.75rem 1rem; border-radius: 12px; font-weight: bold; text-decoration: none; color: #333;">Video 3: Intro to Calculus Part 2</a>
            <a href="#" target="_blank" style="background: #e1baff; padding: 0.75rem 1rem; border-radius: 12px; font-weight: bold; text-decoration: none; color: #333;">Video 4: Introduction to the Derivative</a>
          </div>
          <p style="font-size: 0.95rem;">Press Home To Exit</p>
        </div>
      </section>



      <section class="slide">
        <div class="text-card">
          <p style="font-weight: bold; text-align: center;">Match the function with it's derivative!</p>
      
          <div id="match-board" style="display: flex; gap: 2rem; justify-content: center; margin-top: 1.5rem;">
            <div id="function-column" style="width: 180px;"></div>
            <div id="derivative-column" style="width: 180px;"></div>
          </div>
      
          <p id="match-feedback" style="text-align: center; font-weight: bold; color: red; margin-top: 1rem;"></p>
          <div class="nav-indicator">← 31 →</div>
        </div>
      </section>

      <section class="slide">
        <div class="text-card" style="text-align: center;">
          <h2 style="margin-top: 0.5rem;">First Principles - Lesson I</h2>
          <p style="font-weight: bold; font-size: 1.2rem;">Lesson Summary</p>

          <div style="background: #ffcc00; padding: 1rem; border-radius: 16px; margin: 1.5rem 0;">
            <p style="margin: 0; font-weight: bold;">Learned</p>
            <p style="font-size: 1.5rem;">First Principles</p>
          </div>

          <div style="background: #ffcc00; padding: 1rem; border-radius: 16px; margin: 1.5rem 0;">
            <p style="margin: 0; font-weight: bold;">Matho Stars Earned</p>
            <p style="font-size: 1.5rem;">15</p>
          </div>

          <h3 style="margin-top: 2rem; font-size: 1.5rem;">Good Job!</h3>
          <p style="font-size: 1rem;">Press Home To Exit</p>

          <div class="nav-indicator">← 32</div>
        </div>
      </section>

    </div>
    <script>
      // (all original JS unchanged)
      const slider = document.getElementById('slider');
      const progressBar = document.querySelector('.progress-bar');
      const totalSlides = slider.children.length;
      let currentSlide = 0;

      function getSlideWidth() {
        return slider.clientWidth;
      }

      function goToSlide(index) {
        currentSlide = Math.max(0, Math.min(index, totalSlides - 1));
        const slideWidth = getSlideWidth();
        slider.scrollTo({
          left: currentSlide * slideWidth,
          behavior: 'smooth'
        });
        updateProgressBar();
      }

      function updateProgressBar() {
        const percent = ((currentSlide + 1) / totalSlides) * 100;
        progressBar.style.width = percent + '%';
      }

      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowRight') {
          goToSlide(currentSlide + 1);
        } else if (e.key === 'ArrowLeft') {
          goToSlide(currentSlide - 1);
        }
      });

      slider.addEventListener('scroll', () => {
        const slideWidth = getSlideWidth();
        const index = Math.round(slider.scrollLeft / slideWidth);
        if (index !== currentSlide) {
          currentSlide = index;
          updateProgressBar();
        }
      });

      const canvasTypes = ['Guide', 'Blind'];
      const letters = ['a']; // extend as needed

      function getOffset(canvas, e) {
        const rect = canvas.getBoundingClientRect();
        return {
          x: (e.clientX || e.touches?.[0]?.clientX) - rect.left,
          y: (e.clientY || e.touches?.[0]?.clientY) - rect.top
        };
      }

      function setupCanvas(id) {
        const canvas = document.getElementById('tracingCanvas' + id);
        const ctx = canvas.getContext('2d');
        let drawing = false;

        function startDraw(e) {
          drawing = true;
          const pos = getOffset(canvas, e);
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
        }

        function endDraw() {
          drawing = false;
          ctx.closePath();
          validateDrawing(id);
        }

        function draw(e) {
          if (!drawing) return;
          const pos = getOffset(canvas, e);
          ctx.lineWidth = 5;
          ctx.lineCap = 'round';
          ctx.strokeStyle = '#000';
          ctx.lineTo(pos.x, pos.y);
          ctx.stroke();
          ctx.beginPath();
          ctx.moveTo(pos.x, pos.y);
        }

        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('mouseup', endDraw);
        canvas.addEventListener('mouseout', endDraw);
        canvas.addEventListener('mousemove', draw);

        canvas.addEventListener('touchstart', startDraw, { passive: false });
        canvas.addEventListener('touchend', endDraw);
        canvas.addEventListener('touchcancel', endDraw);
        canvas.addEventListener('touchmove', (e) => {
          e.preventDefault();
          draw(e);
        }, { passive: false });
      }

      function clearCanvas(id) {
        const canvas = document.getElementById('tracingCanvas' + id);
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        document.getElementById('feedback' + id).textContent = '';
      }

      function validateDrawing(id) {
        const canvas = document.getElementById('tracingCanvas' + id);
        const ctx = canvas.getContext('2d');
        const imageData = ctx.getImageData(100, 100, 100, 100);
        let drawn = false;

        for (let i = 0; i < imageData.data.length; i += 4) {
          if (imageData.data[i + 3] > 20) {
            drawn = true;
            break;
          }
        }

        const feedbackEl = document.getElementById('feedback' + id);
        feedbackEl.textContent = drawn ? '' : 'Try tracing more carefully!';
      }

      canvasTypes.forEach(type => {
        letters.forEach(letter => {
          const id = `${type}_${letter}`;
          setupCanvas(id);
        });
      });

      const matchPairs = [
        { id: 1, func: 'f(x)=x', deriv: '1' },
        { id: 2, func: 'f(x)=x<sup>2</sup>', deriv: '2x' },
        { id: 3, func: 'f(x)=x<sup>3</sup>', deriv: '3x<sup>2</sup>' },
        { id: 4, func: 'f(x)=2x<sup>2</sup>', deriv: '4x' },
        { id: 5, func: 'f(x)=8x<sup>2</sup>', deriv: '16x' },
        { id: 6, func: 'f(x)=6x<sup>3</sup>', deriv: '18x<sup>2</sup>' },
      ];

      function selectDeriv(itemDiv) {
        if (itemDiv.classList.contains('correct')) return;
        selectedDeriv = itemDiv;
        tryMatch();
      }
      function shuffle(array) {
        return array
          .map(value => ({ value, sort: Math.random() }))
          .sort((a, b) => a.sort - b.sort)
          .map(({ value }) => value);
      }

      let selectedFunc = null;
      let selectedDeriv = null;

      function renderColumns() {
        const funcCol = document.getElementById('function-column');
        const derivCol = document.getElementById('derivative-column');
        funcCol.innerHTML = "";
        derivCol.innerHTML = "";

        const funcs = shuffle(matchPairs.map(p => ({ label: p.func, id: p.id })));
        const derivs = shuffle(matchPairs.map(p => ({ label: p.deriv, id: p.id })));

        funcs.forEach(item => {
          const div = document.createElement('div');
          div.className = 'match-item';
          div.innerHTML = item.label;
          div.dataset.id = item.id;
          div.onclick = () => selectFunc(div);
          funcCol.appendChild(div);
        });

        derivs.forEach(item => {
          const div = document.createElement('div');
          div.className = 'match-item';
          div.innerHTML = item.label;
          div.dataset.id = item.id;
          div.onclick = () => selectDeriv(div);
          derivCol.appendChild(div);
        });
      }

      function selectFunc(itemDiv) {
        if (itemDiv.classList.contains('correct')) return;
        selectedFunc = itemDiv;
        tryMatch();
      }

      function tryMatch() {
        if (selectedFunc && selectedDeriv) {
          checkMatchPair();
        }
      }

      function checkMatchPair() {
        const feedback = document.getElementById('match-feedback');
        if (selectedFunc.dataset.id === selectedDeriv.dataset.id) {
          selectedFunc.classList.add('correct');
          selectedDeriv.classList.add('correct');
          feedback.textContent = 'Correct!';
          feedback.style.color = '#388e3c';
          checkMatchCompletion();
        } else {
          selectedFunc.classList.add('wrong');
          selectedDeriv.classList.add('wrong');
          feedback.textContent = 'Try again!';
          feedback.style.color = 'red';
          setTimeout(() => {
            selectedFunc.classList.remove('wrong');
            selectedDeriv.classList.remove('wrong');
            feedback.textContent = '';
          }, 800);
        }
        selectedFunc = null;
        selectedDeriv = null;
      }

      function checkMatchCompletion() {
        const funcCol = document.getElementById('function-column');
        const derivCol = document.getElementById('derivative-column');
        const remainingFuncs = [...funcCol.querySelectorAll('.match-item')].filter(item => !item.classList.contains('correct'));
        const remainingDerivs = [...derivCol.querySelectorAll('.match-item')].filter(item => !item.classList.contains('correct'));
        const feedback = document.getElementById('match-feedback');
        if (remainingFuncs.length === 0 && remainingDerivs.length === 0) {
          feedback.textContent = 'Well done!';
          feedback.style.color = '#388e3c';
        }
      }

      renderColumns();
      function playLetterAudio(letterId) {
        const audio = document.getElementById(`audio-${letterId}`);
        if (audio) {
          audio.currentTime = 0; // rewind in case it's already playing
          audio.play().catch(err => {
            console.error("Audio failed to play:", err);
          });
        } else {
          console.error(`Audio element for '${letterId}' not found`);
        }
      }

    </script>
  </div>
</body>
</html>
